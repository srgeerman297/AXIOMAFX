<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AXIOMA FX Comparator</title>
  <meta name="theme-color" content="#0A4FB4" />

  <!-- PWA manifest and icons -->
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
  <link rel="icon" href="icons/icon-192.png" />

  <!-- Minimal styling -->
  <style>
    :root{
      --ax:#0A4FB4; --ax50:#E8F1FF; --border:#cfe0ff; --text:#0f172a; --muted:#475569;
    }
    html,body{height:100%}
    body{
      margin:0; background:#f8fafc; color:var(--text);
      display:flex; align-items:center; justify-content:center; font-family:-apple-system, system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      padding:24px;
    }
    .card{
      background:#fff; border:1px solid var(--border); border-radius:16px; padding:24px; width:min(640px, 95vw);
      box-shadow:0 1px 2px rgba(0,0,0,.04);
      text-align:center;
    }
    h1{margin:0 0 8px 0; color:var(--ax); font-size:28px; line-height:1.2}
    p{margin:6px 0; color:var(--muted)}
    .note{background:var(--ax50); border:1px solid var(--border); padding:10px; border-radius:10px; font-size:14px}
    .err{color:#b91c1c; font-size:12px; margin-top:10px; word-break:break-word}
    .btn{
      appearance:none; border:0; background:var(--ax); color:#fff; padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:600;
    }
    .btn:hover{background:#093F8C}
  </style>
</head>
<body>
  <main class="card" role="main" aria-live="polite">
    <h1>AXIOMA FX Comparator</h1>
    <p>PWA shell loaded successfully ðŸŽ‰</p>
    <p class="note">This is the lightweight, no-framework test page to verify GitHub Pages + iOS load. Your full app can be wired in after this works.</p>
    <div style="margin-top:14px"><button class="btn" id="install">Add to Home Screen (iOS: use Share)</button></div>
    <div id="status" class="err" hidden></div>
  </main>

  <script>
    (function () {
      const status = document.getElementById('status');
      function show(msg){ status.hidden=false; status.textContent=msg; }

      if ('serviceWorker' in navigator) {
        const isSecureOrigin =
          location.protocol === 'https:' ||
          location.hostname === 'localhost' ||
          location.hostname.endsWith('.github.io');

        if (isSecureOrigin) {
          window.addEventListener('load', function () {
            navigator.serviceWorker.register('sw.js')
              .catch(function (err) { show('SW registration failed: ' + err); });
          });
        } else {
          show('Running on insecure origin (' + location.protocol + '); Service Worker is disabled. Open the GitHub Pages URL.');
        }
      }

      // Basic A2HS prompt (desktop/Android; on iOS use Safari â†’ Share â†’ Add to Home Screen)
      let deferredPrompt = null;
      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
      });
      document.getElementById('install').addEventListener('click', async () => {
        if (!deferredPrompt) {
          show('On iPhone: use the Share button â†’ Add to Home Screen.');
          return;
        }
        deferredPrompt.prompt();
        try { await deferredPrompt.userChoice; } catch(_) {}
        deferredPrompt = null;
      });
    })();
  </script>
</body>
</html>
